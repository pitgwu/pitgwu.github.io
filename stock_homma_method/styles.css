:root {
  --snow-white: #ffffff;
  --ice-blue: #dcf2fd;
  --sky-blue: #87ceeb;
  --carrot-orange: #ff9f43;
  --warm-hug-red: #ff4757;  
  --coal-black: #2f3542;    
  --glass-bg: rgba(255, 255, 255, 0.9);
}

body {
  margin: 0;
  padding: 20px;
  background-color: var(--ice-blue);
  background-image: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
  font-family: "Microsoft JhengHei", sans-serif;
  color: var(--coal-black);
  background-attachment: fixed;
}

h1 {
  text-align: center;
  font-size: 2.2em;
  color: var(--coal-black);
  background: var(--snow-white);
  display: inline-block;
  padding: 10px 30px;
  border-radius: 50px;
  border: 4px solid var(--sky-blue);
  position: relative;
  left: 50%;
  transform: translateX(-50%);
  margin-bottom: 30px;
  white-space: nowrap;
}

h1::after {
  content: "⛄";
  position: absolute;
  right: -40px;
  top: 5px;
  font-size: 1em;
}

.main-container {
/* === 修改：改用 Grid 佈局 === */
  display: grid;
  
  /* 自動適應欄寬：最小 350px，空間足夠時平分 (1fr) */
  /* 這行代碼能取代原本的 flex-wrap 和 flex-basis，並保持響應式 */
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  
  gap: 20px;
  max-width: 1400px;
  margin: 0 auto;
  
  /* Grid 預設就是 stretch (拉伸)，這保證了兩欄外框高度一定相等 */
  align-items: stretch;
}

.column {
  flex: 1 1 45%;
  min-width: 350px;
  background: rgba(255, 255, 255, 0.6);
  border: 3px solid var(--snow-white);
  border-radius: 20px;
  padding: 15px;
  backdrop-filter: blur(8px);
}

.column-header {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px dashed var(--sky-blue);
  position: relative;
}

.column-header h2 {
  font-size: 1.5em;
  margin: 0;
}

.seal {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5em;
  font-weight: bold;
  color: white;
  border: 3px solid white;
  position: absolute;
  right: 5px;
  top: -5px;
  transform: rotate(15deg);
}
.seal.buy { background: var(--warm-hug-red); }
.seal.sell { background: #2f3542; }

.accordion {
  background: var(--snow-white);
  color: var(--coal-black);
  cursor: pointer;
  padding: 12px;
  width: 100%;
  border: none;
  text-align: left;
  font-size: 1.1em;
  font-weight: bold;
  border-radius: 12px;
  margin-bottom: 8px;
  border: 2px solid var(--ice-blue);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.accordion.active {
  background-color: var(--carrot-orange);
  color: white;
  border-color: #e67e22;
}

.accordion::after { content: '❄️'; }
.accordion.active::after { transform: rotate(180deg); }

.panel {
  padding: 0 2px;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease-out;
  margin-bottom: 10px;
}

.grid-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 10px;
  padding: 5px 0;
}

.card {
  background: var(--snow-white);
  border-radius: 12px;
  padding: 8px;
  text-align: center;
  border: 1px solid #f1f2f6;
  height: 100%;
  display: flex;
  flex-direction: column;
}
.card:hover { transform: translateY(-3px); border-color: var(--sky-blue); }

.wide-card { grid-column: span 2; }

.card h3 {
  font-size: 0.9em;
  margin: 0 0 5px 0;
  border-bottom: 2px solid var(--ice-blue);
  padding-bottom: 4px;
  min-height: 42px;       /* 修改：增加最小高度，確保兩行標題也不會跑版 */
  display: flex;
  align-items: center;
  justify-content: center;
}

.desc {
  font-size: 0.75em;
  color: #636e72;
  background: #f1f2f6;
  padding: 4px;
  border-radius: 4px;
  flex-grow: 1;
  text-align: left;
  
  /* === 修改 === */
  /* 加大到 80px (約可容納 4-5 行字) */
  /* 強制讓左邊短文字的卡片也跟右邊長文字的一樣高 */
  min-height: 80px; 
  
  display: flex;
  align-items: center;
}

.chart-area {
  height: 80px;
  background: #f7f9fc;
  border-radius: 8px;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 3px;
  position: relative;
  overflow: hidden; 
}

.kb {
  width: 10px;
  position: relative;
  display: inline-block;
  box-shadow: 1px 1px 2px rgba(0,0,0,0.1);
  z-index: 1;
}

.kb::before {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  width: 1px;
  background: #555;
  top: -8px;
  bottom: -8px;
  z-index: 0;
}

.red { background: var(--warm-hug-red); border: 1px solid #d63031; }
.black { background: var(--coal-black); border: 1px solid #000; }
.doji { height: 1px !important; background: #000; width: 12px; border:none; }
.doji::before { height: 26px; top: -13px; background: #000;}

.long { height: 40px; }
.short { height: 16px; }
.mini { height: 8px; width: 6px; }

.trend-down, .trend-up, .stack-col {
  display: flex;
  flex-direction: column;
}

.trend-down .kb { margin-left: 2px; margin-bottom: 2px; }
.trend-down .kb:nth-child(1) { transform: translateX(-8px) translateY(-8px); }
.trend-down .kb:nth-child(2) { transform: translateX(-4px) translateY(-4px); }
.trend-down .kb:nth-child(3) { transform: translateX(0px) translateY(0px); }

.trend-up .kb { margin-left: 2px; margin-bottom: 2px; background: var(--warm-hug-red); border-color: #d63031; }
.trend-up .kb:nth-child(1) { transform: translateX(-8px) translateY(8px); }
.trend-up .kb:nth-child(2) { transform: translateX(-4px) translateY(4px); }
.trend-up .kb:nth-child(3) { transform: translateX(0px) translateY(0px); }

.stack-col { justify-content: center; gap: 2px; margin: 0 4px; }

.hammer::before { top: 100%; height: 15px; } 
.inverted-hammer::before { bottom: 100%; height: 15px; top: auto;} 
.no-top-shadow::before { top: 0; }
.no-bottom-shadow::before { bottom: 0; }

.mt-1 { margin-top: 10px; }
.mt-2 { margin-top: 20px; }
.mb-1 { margin-bottom: 10px; }
.mb-2 { margin-bottom: 20px; }
.gap-x { margin: 0 8px; }
.ml-neg-1 { margin-left: -4px; }

.inside { position: absolute; left: 60%; z-index: 2; }
.piercing { transform: translateX(-5px); z-index: 2; }


/* === 共用前置下跌段 (晨星/梯底風格) === */
/* 定義從高位一路殺下來的三根 K 棒 */
.pos-d-trend-1 { transform: translateY(-35px); } /* 高位起跌 */
.pos-d-trend-2 { transform: translateY(-25px); }
.pos-d-trend-3 { transform: translateY(-15px); } /* 跌勢暫歇 */


/* === 1. 鎚子 (Hammer) 定位修正 === */
.hammer-pattern {
  align-items: center;
  gap: 2px;
  padding-top: 5px;
}
.pos-hammer-main {
  transform: translateY(5px); /* 在趨勢(-15px)之下，形成低點 */
}


/* === 2. 陽吞噬 (Bullish Engulfing) 定位修正 === */
.bullish-engulfing-pattern {
  align-items: center;
  gap: 3px; /* 恢復正常的 K 棒間距 */
  padding-top: 5px;
}
/* 被吞噬的黑K：接續趨勢(-15px)往下，模擬開低 */
.pos-be-victim {
  transform: translateY(-5px); 
  height: 20px; /* 稍微縮小一點，對比才強 */
}
/* 吞噬紅K：左右並排，但位置更低且更高(垂直包覆) */
.pos-be-engulfer {
  /* 垂直位置稍微上移一點點，加上長度夠長，視覺上就會包住左邊 */
  transform: translateY(-8px); 
  height: 45px; /* 加長實體 */
  z-index: 1;
}


/* === 3 & 4. 多頭母子系列 (Bullish Harami) 定位修正 === */
.bullish-harami-pattern {
  align-items: center;
  gap: 3px; /* 恢復間距 */
  padding-top: 5px;
}
/* 母線(長黑)：接續趨勢，長度夠長 */
.pos-bhm-mother {
  transform: translateY(0px); 
  height: 45px; /* 母線要長 */
}
/* 子線(紅K)：位於母線右側，但垂直位置在母線中間 */
.pos-bhm-baby {
  /* 移除 absolute positioning，改用 transform 微調垂直位置 */
  transform: translateY(0px); /* 因為父層 center 對齊，0px 就會剛好在母線中間 */
  height: 15px; /* 小小的子線 */
}
/* 子線(十字)：位於母線右側，垂直居中 */
.pos-bhm-baby-cross {
  transform: translateY(0px);
}


/* === 7. 倒鎚子 (Inverted Hammer) 定位修正 === */
.inverted-hammer-pattern {
  align-items: center;
  gap: 2px;
  padding-top: 5px;
}

/* 1. 加速長黑 K：接續在下跌趨勢(-15px)之後 */
.pos-ih-climax {
  transform: translateY(5px); /* 位置較低，長度長，顯示最後殺盤 */
  height: 45px;
}

/* 2. 倒鎚子本體 */
.pos-ih-main {
  transform: translateY(25px); /* 明顯跳空向下，位於低檔 */
  height: 12px; /* 實體很小 */
  z-index: 2;
}

/* 3. 倒鎚子專用外型 (確保上影線長，無下影線) */
.inverted-hammer-shape::before {
  content: '';
  position: absolute;
  width: 1px;
  background-color: #555;
  left: 50%;
  transform: translateX(-50%);
  
  /* 關鍵：上影線長，無下影線 */
  bottom: 100%; /* 從實體頂部開始往上畫 */
  height: 25px; /* 上影線長度約實體 2 倍 */
  top: auto; /* 取消預設的 top */
}

/* 確保沒有下影線 (覆蓋預設樣式) */
.inverted-hammer-shape::after {
  content: none; /* 移除下影線 */
}

/* === 10. 貫穿線 (Piercing Pattern) 定位修正 === */
.piercing-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 10px;
}

/* 複用之前的下跌趨勢樣式，只需微調位置 */
.piercing-pattern .pos-d-trend-1 { transform: translateY(-35px); }
.piercing-pattern .pos-d-trend-2 { transform: translateY(-25px); }

/* 1. 第一根長黑K：接續跌勢，位置較低 */
.pos-pp-black {
  transform: translateY(1px); 
  height: 50px; /* 長黑實體 */
  z-index: 1;
}

/* 2. 第二根長紅K：關鍵定位 */
.pos-pp-red {
  /* 關鍵計算：
    - 黑K中心在 5px，高度 50px -> 實體範圍約為 -20px(頂) 到 30px(底)。中線在 5px。
    - 紅K要跳空開低 -> 開盤價要在 30px 以下。
    - 紅K要貫穿中線 -> 收盤價要高於 5px。
  */
  transform: translateY(15px); /* 整體位置下移，確保開盤在低位 */
  height: 45px; /* 足夠長的實體，從低位向上貫穿 */
  /* 在此設定下，紅K實體範圍約為 -12.5px(頂) 到 42.5px(底)。
    - 底部(42.5px)低於黑K底部(30px) -> 模擬跳空開低。
    - 頂部(-12.5px)高於黑K中線(5px) -> 成功貫穿中線以上。
  */
  box-shadow: 0 0 10px rgba(255, 71, 87, 0.4); /* 增加反擊的氣勢 */
  z-index: 2;
}

/* === 9. 多頭執帶 (Bullish Belt Hold) 定位修正 === */
.bullish-belt-hold-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 15px;
}

/* 主體：光腳長紅 */
.pos-bbh-bullish-main {
  /* 前方趨勢結束在 -15px (pos-d-trend-3) */
  /* 我們將這根長紅設定在 -15px，讓它的底部(開盤)接近趨勢的低點，然後向上延伸 */
  transform: translateY(-15px);
  height: 55px; /* 特長紅K，顯示反轉力道 */
  box-shadow: 0 0 10px rgba(255, 71, 87, 0.4); /* 增加多頭氣勢的光暈 */
  z-index: 1;
}

/* === 共用前置下跌段 (與梯底相同) === */
/* 模擬從高位一路殺下來的階梯 */
.pos-trend-down-1 { transform: translateY(-15px); } /* 高位起跌 */
.pos-trend-down-2 { transform: translateY(-5px); }
.pos-trend-down-3 { transform: translateY(5px); } /* 跌到中線 */

/* === 晨星系列 (Morning Star Patterns) 專用定位 (向上修正版) === */
.morning-star-pattern {
  align-items: center;
  gap: 2px;
  padding-top: 5px;
}

/* 新增：晨星專用的前置下跌段 (位置較高，為底部留空間) */
.pos-ms-trend-1 { transform: translateY(-35px); } /* 從更高處起跌 */
.pos-ms-trend-2 { transform: translateY(-25px); }
.pos-ms-trend-3 { transform: translateY(-15px); } /* 跌勢暫歇在較高位置 */

/* 1. 第一根長黑 (接續跌勢) */
/* 從原本的 15px 上移到 -5px */
.pos-ms-1 {
  transform: translateY(-5px); 
}

/* 2. 中間星線/十字 (跳空向下，底部) */
/* 從原本看不見的 35px 上移到清晰可見的 25px */
.pos-ms-star {
  transform: translateY(25px); 
  z-index: 2;
}

/* 3. 第三根確認長紅 (跳空向上) */
/* 從 15px 上移到 -5px */
.pos-ms-confirm {
  transform: translateY(-5px); 
  box-shadow: 0 0 8px rgba(255, 71, 87, 0.4);
}

/* -- 多頭棄嬰特規 -- */
/* 從看不見的 42px 上移到 35px */
.pos-abandoned-baby-star {
  transform: translateY(35px); 
}
/* 從 12px 上移到 -10px */
.pos-abandoned-baby-confirm {
  transform: translateY(-10px); 
}

/* === 多頭三星 (Bullish Tri-Star) 專用定位 (修正版) === */
.tri-star-bullish-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
}


/* === 新增：多頭遭遇線 (Bullish Meeting Lines) 專用定位 === */
.bullish-meeting-lines-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
  /* 稍微增加 chart-area 高度以容納大幅跳空的紅K，避免被切掉 */
  min-height: 60px; 
}

/* 複用之前的下跌趨勢樣式，只需微調位置 */
/* .pos-d-trend-1 { transform: translateY(-25px); } */
/* .pos-d-trend-2 { transform: translateY(-15px); } */

/* 1. 第一根長黑K：位置較低，代表跌勢延續 */
.pos-bml-black {
  transform: translateY(-5px); /* 中心點位移 */
  height: 30px; /* 高度 */
  z-index: 1;
  /* 計算關鍵：
     黑K中心在 5px，半高為 25px。
     -> 黑K底部(收盤價)位置 = 5 + 25 = 30px。
  */
}

/* 2. 第二根長紅K：關鍵定位 - 收盤價(頂部)要對齊黑K收盤價(底部) */
.pos-bml-red {
  /*
     目標：紅K頂部(收盤價) = 30px (精準對齊黑K底部)
     設定：紅K高度 = 60px (顯示大幅反彈的力道)
     計算：紅K中心點 = 目標頂部 + 半高 = 30 + (60/2) = 60px。
  */
  transform: translateY(20px);
  height: 20px;
  /*
     視覺驗證：
     紅K頂部(收盤) = 60 - 30 = 30px -> 完美對齊黑K底部。
     紅K底部(開盤) = 60 + 30 = 90px -> 形成從 30px 到 90px 的巨大跳空缺口。
  */
  box-shadow: 0 0 8px rgba(255, 71, 87, 0.4); /* 增加多頭頑強抵抗的光暈 */
  z-index: 2;
}


/* === 新增：內困三日紅 (Three Inside Up) 專用定位 === */
.three-inside-up-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 10px;
}

/* 複用下跌趨勢 (pos-d-trend-1, 2) */

/* 1. 第一根長黑K：母線 */
.pos-tiu-1 {
  /* 設定中心點在 5px */
  /* 高度 50px -> 範圍：頂部(開盤) -20px 到 底部(收盤) 30px */
  transform: translateY(5px); 
  height: 50px; 
  z-index: 1;
}

/* 2. 第二根小紅K：子線 (母子型態) */
.pos-tiu-2 {
  /* 必須在黑K實體範圍內 (-20px ~ 30px) */
  /* 設定在偏下方，顯示低檔有撐 */
  transform: translateY(15px); 
  height: 20px; 
  /* 視覺位置：頂 5px ~ 底 25px，完全在黑K肚量內 */
}

/* 3. 第三根長紅K：關鍵突破 */
.pos-tiu-3 {
  /* 目標：收盤價(頂部) 必須高於 黑K開盤價(-20px)
     設定：高度 60px (長紅)
     中心點設在 -10px
     -> 頂部(收盤) = -10 - 30 = -40px (明顯高於 -20px，達成突破!)
     -> 底部(開盤) = -10 + 30 = 20px (接近第二根的收盤)
  */
  transform: translateY(-10px);
  height: 60px;
  box-shadow: 0 0 10px rgba(255, 71, 87, 0.5); /* 增加確認反轉的強勢光暈 */
  z-index: 2;
}


/* === 新增：雙錘打椿 (Twin Hammers) 專用定位 === */
.twin-hammers-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
}

/* 複用下跌趨勢 pos-d-trend-1, 2 (位置不動) */

/* 1. 第一根錘子：位於最低點，用力探底 */
.pos-th-1 {
  transform: translateY(15px); /* 低檔位置 */
}

/* 2. 第二根錘子：位置稍高，顯示打樁成功，底部墊高 */
.pos-th-2 {
  transform: translateY(8px); /* 比第一根高一些 */
}

/* 專用樣式：加長下影線，符合「影線大於實體」的定義 */
.twin-hammers-pattern .twin-hammer-shadow::before {
  height: 22px; /* 原本 hammer 是 15px，這裡加長 */
  /* short 高度為 16px，22px 的影線會明顯長於實體 */
}


/* === 6. 紅三兵 (Three White Soldiers) 定位修正 === */
.three-white-soldiers-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 10px;
}

/* 1. 第一兵：在低檔出現，扭轉跌勢 */
/* 趨勢結束在 -15px (高位)，第一兵設在 0px (低位)，形成反轉起點 */
.pos-tws-1 {
  transform: translateY(0px); 
}

/* 2. 第二兵：持續向上攻擊 */
.pos-tws-2 {
  transform: translateY(-12px);
}

/* 3. 第三兵：再創新高，確認多頭氣勢 */
.pos-tws-3 {
  transform: translateY(-24px); /* 爬升到比起跌點還高的位置 */
  box-shadow: 0 0 5px rgba(255, 71, 87, 0.4); /* 增加一點氣勢光暈 */
}


/* === 新增：紅三空 (Red Three Gaps) 專用定位 === */
.red-three-gaps-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 15px;
  /* 增加高度以容納連續跳空的漲幅 */
  min-height: 60px; 
}

/* 1. 起始紅K (位置最低) */
.pos-r3g-start {
  transform: translateY(40px);
}

/* 2. 第一個跳空紅K */
.pos-r3g-1 {
  /* 計算邏輯 (簡化)：
     前一根頂部約在 36px。
     這根底部(開盤)必須高於 36px。
     設定中心在 20px (short高度16px)，底部在 28px。
     -> 成功創造第一個缺口。
  */
  transform: translateY(20px);
}

/* 3. 第二個跳空紅K */
.pos-r3g-2 {
  /* 前一根頂部在 12px。
     這根底部設在 8px。
     -> 成功創造第二個缺口。
  */
  transform: translateY(0px);
}

/* 4. 第三個跳空紅K (加速趕頂，長紅) */
.pos-r3g-3 {
  /* 前一根頂部在 -8px。
     這根是長紅(高度40px)，中心設在 -30px，底部在 -10px。
     -> -10px 高於 -8px，成功創造第三個缺口。
  */
  transform: translateY(-30px);
  height: 40px; /* 最後一根加速 */
  box-shadow: 0 0 15px rgba(255, 71, 87, 0.6); /* 強烈的光暈，顯示極端情緒 */
  z-index: 2;
}



/* 新增：晨星專用的前置下跌段 (位置較高，為底部留空間) */
.pos-trend-down-1 { transform: translateY(-35px); } /* 從更高處起跌 */
.pos-trend-down-2 { transform: translateY(-25px); }
.pos-trend-down-3 { transform: translateY(-15px); } /* 跌勢暫歇在較高位置 */

/* 第一根十字 (接續跌勢) */
.pos-bts-1 { transform: translateY(15px); }

/* 第二根 (跳空底部) */
.pos-bts-2 { transform: translateY(30px); }

/* 第三根 (關鍵確認，向上) */
.pos-bts-3 { 
  transform: translateY(15px); 
  box-shadow: 0 0 5px rgba(255, 71, 87, 0.5);
}



/* === 三川底 (Three River Bottom / Inverted H&S) 專用定位 (參考圖優化版) === */
.three-river-bottom-pattern {
  align-items: center;
  gap: 2px;
  padding-bottom: 5px; /* 預留底部空間 */
  min-height: 100px;
  /* 視覺上的頸線(壓力線)大約在 translateY(-15px) 的位置 */
}

/* 1. 下跌起始點 */
.pos-tr-start { transform: translateY(-35px); }

/* 2. 左肩谷底 (下探) */
/* 頂部 -15px (頸線), 底部 5px */
.pos-tr-ls { 
  transform: translateY(-5px); 
}

/* 3. 左肩反彈 (回到頸線 -15px) */
.pos-tr-nk1 { transform: translateY(-15px); }

/* 4. 頭部谷底 (最深) */
/* 頂部 -15px, 底部 25px (最深點) */
.pos-tr-head {
  transform: translateY(5px); 
  height: 40px; 
}

/* 5. 頭部反彈 (回到頸線 -15px) */
/* 底部 25px, 頂部 -15px */
.pos-tr-nk2 {
  transform: translateY(5px);
  height: 40px;
}

/* 6. 右肩谷底 (不再破底，約 5px) */
.pos-tr-rs { 
  transform: translateY(-5px); 
}

/* 7. 突破頸線 (長紅向上衝) */
/* 底部 5px, 頂部 -45px (大幅突破 -15px 頸線) */
.pos-tr-break {
  transform: translateY(-20px); 
  height: 50px; 
  box-shadow: 0 0 10px rgba(255, 71, 87, 0.6); /* 突破光暈 */
  z-index: 2;
}




/* === 上升三法 (Rising Three Methods) 專用定位 (修正版：維持在 1/2 之上) === */
.rising-three-pattern {
  align-items: center; /* 垂直置中基準 */
  gap: 3px;
  padding-top: 15px; /* 預留上方突破空間 */
}

/* 長紅 K 高度為 40px，在 Flex center 排列下：
   - 上半部範圍約為 translateY(-20px) 到 translateY(0px)
   - 下半部範圍約為 translateY(0px) 到 translateY(20px)
   
   我們將小黑 K (高度16px) 往上移動 (負值)，使其停留在上半部。
*/

.pos-r1 {
  transform: translateY(-12px); /* 第一根：最高，接近長紅頂部 */
}

.pos-r2 {
  transform: translateY(-7px);  /* 第二根：稍微往下，但仍在上方 */
}

.pos-r3 {
  transform: translateY(-2px);  /* 第三根：最低，但守住中線(1/2)位置，不跌破 */
}

/* 最後一根紅 K 向上位移，表現出突破新高的氣勢 */
.pos-r-break {
  transform: translateY(-15px); /* 設為負值使其往上衝，與前面的高點形成突破 */
}

/* === 多頭起跑 (築底突破) 專用定位 === */
.kicking-breakout-pattern {
  align-items: center;
  gap: 2px; /* K棒間距緊密一點顯示整理感 */
  padding-top: 15px; /* 預留上方突破空間 */
}

/* 1. 下降軌道：位置較高，逐步往下 */
.pos-kb-d1 { transform: translateY(-10px); }
.pos-kb-d2 { transform: translateY(0px); }

/* 2. 橫盤整理區間：紅黑交錯，重點是「不破底」 */
/* 我們設定一個視覺上的底部支撐大約在 translateY(15px) 左右 */

.pos-kb-s1 { /* 小紅反彈 */
  transform: translateY(10px); 
}

.pos-kb-s2 { /* 小黑回測，低點支撐住 */
  transform: translateY(14px);
}

.pos-kb-s3 { /* 較強一點的小紅反彈，蓄力感 */
  transform: translateY(8px);
}

.pos-kb-s4 { /* 最後一次小黑確認支撐 */
  transform: translateY(12px);
}

/* 3. 向上突破：強勢噴出，超越前方所有高點 */
.pos-kb-break {
  transform: translateY(-25px); /* 大幅向上位移，表現突破張力 */
  box-shadow: 0 0 15px rgba(255, 71, 87, 0.6); /* 強烈的突破光暈 */
  z-index: 2; /* 確保壓在其他元素上方 */
}

/* 微調此模式下的小K棒尺寸，讓整理區間看起來更糾結 */
.kicking-breakout-pattern .mini { height: 6px; }
.kicking-breakout-pattern .short { height: 15px; }


/* === 多頭三明治 (Bullish Stick Sandwich) 定位優化 === */
.bullish-sandwich-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
}

/* 複用共用的下跌趨勢 (pos-d-trend-1~3) */

/* 1. 第一根長黑：建立底部支撐 */
.pos-bus-1 {
  /* 修改：從 5px 下移至 10px，讓開盤價更貼近前方趨勢的收盤價 */
  /* 高度 40px -> 頂部(開盤) -10px，底部(收盤) 30px */
  transform: translateY(10px);
  height: 40px;
}

/* 2. 第二根紅K：夾心層 */
.pos-bus-2 {
  /* 修改：配合下移至 5px */
  /* 高度 20px -> 頂部(收盤) -5px，底部(開盤) 15px */
  /* 開盤價 15px 高於前一日收盤 30px (視覺上較高)，符合反彈 */
  transform: translateY(5px); 
  height: 20px;
}

/* 3. 第三根長黑：再次回測支撐 */
.pos-bus-3 {
  /* 關鍵：必須確保底部(收盤) = 30px (與第一根相同) */
  /* 設定高度 50px */
  /* 計算：中心點 = 目標底部(30) - 半高(25) = 5px */
  transform: translateY(5px);
  height: 50px;
  
  /* 視覺驗證：
     底部 5 + 25 = 30px (完美對齊第一根底部)
     頂部 5 - 25 = -20px (開盤價高於前日收盤 -5px，符合開高殺低) 
  */
  box-shadow: 0 4px 4px -2px rgba(255, 71, 87, 0.6); /* 底部紅色光暈暗示支撐 */
  z-index: 2;
}


/* === 梯底 (Ladder Bottom) 定位修正 (參考圖優化版) === */
.ladder-bottom-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 10px;
}

/* 1. 第一根長黑：起跌，實體最長 */
.pos-lb-1 {
  transform: translateY(-30px); /* 最高位 */
  height: 35px;
}

/* 2. 第二根中黑：位置下降，實體縮短 */
.pos-lb-2 {
  transform: translateY(-10px);
  height: 25px; /* 比第一根短 */
}

/* 3. 第三根小黑：位置再降，實體更短 */
.pos-lb-3 {
  transform: translateY(10px);
  height: 15px; /* 明顯縮短 */
}

/* 4. 第四根極短黑：最低點，賣壓竭盡 */
.pos-lb-4 {
  transform: translateY(25px); /* 最低位 */
  height: 8px; /* 幾乎只剩一條線 */
}
/* 加一點下影線，模擬試探底部的感覺 */
.pos-lb-4::before {
  height: 12px; 
  top: 4px; /* 向下延伸 */
}

/* 5. 第五根跳空長紅：V型反轉 */
.pos-lb-break {
  /* 關鍵定位：
     第四根黑K頂部(開盤)約在 21px。
     這根紅K底部(開盤)設定在 15px。
     -> 15px 高於 21px，形成視覺上的「跳空開高」。
  */
  transform: translateY(-15px); /* 向上衝刺 */
  height: 60px; /* 超長紅K，一舉吞噬前面三根黑K */
  box-shadow: 0 0 12px rgba(255, 71, 87, 0.6); /* 強烈反轉光暈 */
  z-index: 2;
}


/* === 吊人 (高檔乖離 + 確認) 專用定位 === */
.hanging-man-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px; 
}

/* 1. 連續上升段 (製造趨勢) */
.pos-hm-1 { transform: translateY(15px); }
.pos-hm-2 { transform: translateY(5px); }
.pos-hm-3 { transform: translateY(-5px); } /* 加速感 */

/* 2. 吊人本體 (高檔乖離) */
.pos-hm-main {
  transform: translateY(-20px); /* 跳空或急拉至高點 */
  z-index: 2;
}

/* 特別加長下影線 (覆蓋原本的 shadow 樣式) */
.hanging-long-shadow::before {
  top: 100%; /* 從實體底部開始 */
  height: 25px; /* 特長下影線，約實體的 1.5~2 倍 */
  background: #555;
  width: 1px;
}

/* 3. 確認訊號 (長黑K) */
.pos-hm-confirm {
  transform: translateY(-5px); /* 開盤在吊人實體附近，一路殺低 */
  height: 45px; /* 加長黑K長度，顯示賣壓沉重 */
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.3); /* 陰森的下殺光暈 */
}

/* 針對此模式的微調 */
.hanging-man-pattern .mini { height: 8px; }
.hanging-man-pattern .short { height: 16px; }


/* === 陰吞噬 (高檔轉空) 專用定位 === */
.bearish-engulfing-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
}

/* 1. 連續上升段 (陡峭) */
.pos-be-1 { transform: translateY(15px); }
.pos-be-2 { transform: translateY(5px); }

/* 2. 被吞噬的紅K (位於高檔) */
.pos-be-victim {
  transform: translateY(-5px); /* 相對高點 */
  z-index: 1;
}

/* 3. 吞噬者 (大長黑K) */
.pos-be-engulfer {
  transform: translateY(-5px); /* 中心點與紅K對齊，確保包覆 */
  height: 55px; /* 特大號實體，上下皆超出紅K範圍 */
  /* 開盤價(上)比紅K收盤更高，收盤價(下)比紅K開盤更低 -> 完美包覆 */
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.4); /* 增加黑K的威壓感 */
  z-index: 2;
}

/* 微調此模式下的K棒尺寸 */
.bearish-engulfing-pattern .mini { height: 8px; }
.bearish-engulfing-pattern .short { height: 18px; } /* 被吞噬者不能太大，對比才明顯 */


/* === 空頭母子 (Bearish Harami / 懷抱線 - 黑抱黑變體) 專用定位 === */
.bearish-harami-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
}

/* 1. 急漲段 */
.pos-bh-up1 { transform: translateY(12px); }
.pos-bh-up2 { transform: translateY(2px); }

/* 2. 母線 (中黑K, 高檔) */
.pos-bh-mother {
  transform: translateY(-8px); /* 位於相對高點 */
  height: 25px; /* 中長度 */
}

/* 3. 子線 (小黑K, 被懷抱) */
.pos-bh-baby {
  /* 修正：移除 margin-left，讓 K 棒左右並排不重疊 */
  /* margin-left: -13px;  <-- 已移除 */
  /* border: 1px solid #fff; <-- 已移除 */
  
  /* 垂直位置設定與母線相同 (-8px)，確保它在母線的垂直範圍內(肚子裡) */
  transform: translateY(-8px); 
}


/* === 空頭母子十字 (Harami Cross / 懷抱線 - 紅抱十字) 專用定位 === */
.bearish-harami-cross-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
}

/* 1. 急漲段 */
.pos-bhc-up1 { transform: translateY(12px); }
.pos-bhc-up2 { transform: translateY(2px); }

/* 2. 母線 (大紅K, 高檔) */
.pos-bhc-mother {
  transform: translateY(-8px); /* 位於相對高點 */
}

/* 3. 子線 (十字, 被懷抱) */
.pos-bhc-baby {
  /* 修正：移除 margin-left，讓 K 棒左右並排不重疊 */
  /* margin-left: -13px; <-- 已移除 */
  
  /* 垂直位置設定與母線相同 (-8px)，十字線會剛好浮在紅K實體的中間 */
  transform: translateY(-8px);
}


/* === 8. 流星 (Shooting Star) 定位與形狀修正 === */
.shooting-star-pattern {
  align-items: center;
  gap: 2px;
  padding-top: 15px; /* 預留上方長影線的空間 */
}

/* 1. 前置急漲段 (模擬參考圖，越來越強) */
.pos-trend-up-1 { transform: translateY(15px); }
.pos-trend-up-2 { transform: translateY(5px); }
.pos-trend-up-3 {
    transform: translateY(-5px);
    height: 35px; /* 最後一根長紅趕頂 */
}

/* 2. 流星本體定位 */
.pos-shooting-star-main {
  transform: translateY(-25px); /* 高高掛起，形成跳空缺口 */
  height: 10px; /* 實體很小 */
  z-index: 2;
}

/* 3. 流星專用外型 (關鍵：確保上影線極長，無下影線) */
.shooting-star-shape::before {
  content: '';
  position: absolute;
  width: 1px;
  background-color: #555;
  left: 50%;
  transform: translateX(-50%);

  /* 關鍵設定：從實體頂部往上畫 */
  bottom: 100%; 
  height: 30px; /* 上影線長度約實體 3 倍，符合參考圖比例 */
  top: auto; /* 取消預設的 top 定位 */
}

/* 確保沒有下影線 (強制覆蓋可能存在的預設樣式) */
.shooting-star-shape::after {
  content: none !important;
}


/* === 新增：空頭遭遇線 (Bearish Meeting Lines) 專用定位 === */
.bearish-meeting-lines-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 20px; /* 預留上方大幅跳空開高的空間 */
  min-height: 60px; /* 增加高度以容納長K線 */
}

/* 1. 前置上漲趨勢 (配合下方紅K的位置調整) */
.pos-bml-trend-1 { transform: translateY(25px); }
.pos-bml-trend-2 { transform: translateY(15px); }

/* 2. 第一根長紅K：位置偏下，為上方跳空留出空間 */
.pos-bml-bear-red {
  /* 設定紅K中心點在 25px */
  /* 高度 50px -> 頂部(收盤價)位置 = 25 - 25 = 0px (基準線) */
  transform: translateY(-5px); 
  height: 35px; 
  z-index: 1;
}

/* 3. 第二根長黑K：關鍵定位 - 收盤價(底部)要對齊紅K收盤價(頂部) */
.pos-bml-bear-black {
  /*
     目標：黑K底部(收盤價) = 0px (精準對齊紅K頂部)
     設定：黑K高度 = 50px
     計算：黑K中心點 = 目標底部 - 半高 = 0 - 25 = -25px。
  */
  transform: translateY(-35px);
  height: 25px;
  /*
     視覺驗證：
     黑K底部(收盤) = -25 + 25 = 0px -> 完美對齊紅K頂部。
     黑K頂部(開盤) = -25 - 25 = -50px -> 形成從 0px 到 -50px 的巨大跳空開高。
  */
  box-shadow: 0 0 8px rgba(47, 53, 66, 0.4); /* 增加空頭反撲的陰影 */
  z-index: 2;
}


/* === 11. 烏雲蓋頂 (Dark Cloud Cover) 定位修正 === */
.dark-cloud-cover-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 15px; /* 預留上方跳空空間 */
}

/* 複用之前的上升趨勢樣式 (與吊人/夜星相同) */
/* .pos-trend-1 { transform: translateY(15px); } */
/* .pos-trend-2 { transform: translateY(5px); } */

/* 1. 第一根長紅K：接續漲勢，位置較高 */
.pos-dcc-red {
  transform: translateY(-15px); 
  height: 50px; /* 長紅實體 */
  z-index: 1;
}

/* 2. 第二根長黑K：關鍵定位 */
.pos-dcc-black {
  /* 關鍵計算：
     - 紅K中心在 -5px，高度 50px -> 實體範圍 -30px(頂/收盤) 到 20px(底/開盤)。中線在 -5px。
     - 黑K要跳空開高 -> 開盤價(頂)要在 -30px 之上 (例如 -35px)。
     - 黑K要貫穿中線 -> 收盤價(底)要低於 -5px (例如 15px)。
  */
  transform: translateY(-20px); /* 中心點設定 */
  height: 50px; /* 高度設定 */
  
  /* 視覺結果：
     - 黑K頂部：-10 - 25 = -35px (高於紅K頂部 -30px) -> 成功跳空開高。
     - 黑K底部：-10 + 25 = 15px (低於紅K中線 -5px) -> 成功貫穿中線。
  */
  
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.4); /* 增加烏雲罩頂的壓迫感 */
  z-index: 2;
}


/* === 共用前置急漲段 (與吊人相同) === */
/* 這三根定義了從低到高的爬升過程 */
.pos-trend-1 { transform: translateY(15px); }
.pos-trend-2 { transform: translateY(5px); }
.pos-trend-3 { transform: translateY(-5px); } /* 趨勢的高點 */

/* === 夜星系列 (Evening Star Patterns) 專用定位 (修正版) === */
.evening-star-pattern {
  align-items: center;
  gap: 2px;
  padding-top: 15px; /* 預留更多上方空間給高檔星線 */
}

/* 1. 第一根長紅 (接續趨勢高點) */
/* 趨勢結束在 -5px，長紅從 -5px 附近開始往上延伸 */
.pos-es-1 {
  transform: translateY(-5px); 
}

/* 2. 中間星線/十字 (跳空向上) */
/* 必須比長紅更高，形成明顯頭部 */
.pos-es-star {
  transform: translateY(-35px); /* 高懸在頭部 */
  z-index: 2;
}

/* 3. 第三根確認黑K (跳空向下) */
/* 回落到與第一根長紅差不多的位置，確認吞噬或貫穿 */
.pos-es-confirm {
  transform: translateY(-5px); 
  box-shadow: 0 0 8px rgba(47, 53, 66, 0.3);
}

/* -- 空頭棄嬰特規 (缺口更大) -- */
.pos-abandoned-star {
  transform: translateY(-45px); /* 飛得更高 (孤島) */
}
.pos-abandoned-confirm {
  transform: translateY(0px); /* 跌得更深，缺口更明顯 */
}


/* === 空頭三星 (Bearish Tri-Star) 專用定位 (修正版：整組懸浮於紅K之上) === */
.tri-star-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 20px; /* 增加上方空間，因為整組往上提了 */
}

/* 趨勢的高點紅K大約在 translateY(-5px) */

/* 第一根十字：明顯跳空向上，高於紅K */
.pos-ts-1 { 
  transform: translateY(-18px); /* 從 -5px 跳升到 -18px，拉出缺口 */
}

/* 第二根十字：再跳空創最高點 (頂部) */
.pos-ts-2 { 
  transform: translateY(-30px); /* 最高點十字 */
}

/* 第三根十字：跳空向下，但依然維持在高檔區，高於紅K */
.pos-ts-3 { 
  transform: translateY(-18px); /* 回到第一根的高度，確認做頭 */
  box-shadow: 0 0 5px rgba(0,0,0,0.5); /* 關鍵確認 */
}

/* === 空頭執帶 (Bearish Belt Hold) 專用定位 === */
.bearish-belt-hold-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 15px; /* 預留上方跳空空間 */
}

/* 主體：跳空開高，光頭長黑 */
.pos-bbh-main {
  /* 前方趨勢高點約在 -5px 左右 */
  /* 我們將這根黑K中心點定在 0px，配合特長高度，營造跳空開高後殺低的效果 */
  transform: translateY(0px);
  height: 60px; /* 特長黑K，顯示帶量下殺的沉重感 */
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.5); /* 增加陰影，強化空頭氣勢 */
  z-index: 2;
}


/* === 新增：內困三日黑 (Three Inside Down) 專用定位 === */
.three-inside-down-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 15px;
}

/* 1. 前置上漲趨勢 */
.pos-tid-trend-1 { transform: translateY(15px); }
.pos-tid-trend-2 { transform: translateY(5px); }

/* 2. 第一根長紅K：母線 (位置較高) */
.pos-tid-1 {
  /* 設定中心點在 -10px */
  /* 高度 50px -> 範圍：頂部(收盤) -35px 到 底部(開盤) 15px */
  transform: translateY(-10px); 
  height: 50px; 
  z-index: 1;
}

/* 3. 第二根小黑K：子線 (空頭母子) */
.pos-tid-2 {
  /* 必須在紅K實體範圍內 (-35px ~ 15px) */
  /* 設定在偏上方，顯示高檔無力 */
  transform: translateY(-20px); 
  height: 20px; 
  /* 視覺位置：頂 -30px ~ 底 -10px，完全在紅K肚量內 */
}

/* 4. 第三根長黑K：關鍵跌破 */
.pos-tid-3 {
  /* 目標：收盤價(底部) 必須低於 紅K開盤價(15px)
     設定：高度 60px (長黑)
     中心點設在 10px
     -> 頂部(開盤) = 10 - 30 = -20px (接近第二根的收盤)
     -> 底部(收盤) = 10 + 30 = 40px (明顯低於 15px，達成跌破!)
  */
  transform: translateY(10px);
  height: 50px;
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.5); /* 增加殺盤確認的強勢光暈 */
  z-index: 2;
}


/* === 新增：反錘兩極 (Twin Shooting Stars) 專用定位 === */
.reverse-hammers-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 15px;
}

/* 前置上漲趨勢 */
.pos-rh-trend-1 { transform: translateY(15px); }
.pos-rh-trend-2 { transform: translateY(5px); }

/* 1. 第一根反錘 (高檔長黑倒錘/流星) */
.pos-rh-1 {
  transform: translateY(-15px); /* 位於高檔 */
  height: 12px; /* 實體短小 */
  z-index: 2;
}

/* 2. 第二根反錘 (跳空開低) */
.pos-rh-2 {
  /* 設定位置比第一根明顯低很多，製造 "跳空開低" 的視覺效果 */
  transform: translateY(10px); 
  height: 12px;
  z-index: 2;
  
  /* 視覺邏輯：
    第一根收盤(底部)約在 -9px。
    第二根開盤(頂部)約在 4px。
    4px > -9px，視覺上出現了明顯的向下缺口。
  */
}

/* 複用 shooting-star-shape 的樣式 (長上影線、無下影線) 
   因為在 HTML 中已經加上了該類別，所以不需要額外寫 CSS，
   它會自動畫出長長的 "避雷針" 上影線。
*/



/* === 三烏鴉 (Three Black Crows) 專用定位 === */
.three-crows-pattern {
  align-items: center;
  gap: 3px; /* 正常的間隙 */
  padding-top: 10px;
}

/* 1. 第一隻烏鴉：在高檔出現，稍微吞噬紅K高點 */
.pos-3c-1 {
  transform: translateY(-15px); 
}

/* 2. 第二隻烏鴉：明顯的階梯向下 */
.pos-3c-2 {
  transform: translateY(-7px);
}

/* 3. 第三隻烏鴉：繼續階梯向下 */
.pos-3c-3 {
  transform: translateY(1px);
}


/* === 三胎鴉 (Identical Three Crows) 專用定位 === */
.identical-crows-pattern {
  align-items: center;
  gap: 3px; /* 正常的間隙 */
  padding-top: 10px;
}

/* 1. 第一隻胎鴉：高檔開始 */
.pos-ic-1 {
  transform: translateY(-2px);
}

/* 2. 第二隻胎鴉：緊貼著第一隻的底部開始跌 */
/* short 高度為 16px，中心點位移約 16px 剛好接上 */
.pos-ic-2 {
  transform: translateY(14px); 
}

/* 3. 第三隻胎鴉：緊貼著第二隻的底部 */
.pos-ic-3 {
  transform: translateY(30px);
}

/* 微調烏鴉系列的影線，讓實體重疊更明顯 */
.three-crows-pattern .kb::before,
.identical-crows-pattern .kb::before {
    top: -4px; bottom: -4px; /* 縮短影線，強調實體 */
}


/* === 新增：大敵當前 (Advance Block) 專用定位 === */
.advance-block-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 15px;
}

/* 前置趨勢 */
.pos-ab-trend-1 { transform: translateY(25px); }
.pos-ab-trend-2 { transform: translateY(15px); }

/* 1. 第一根：氣勢最強的長紅 */
.pos-ab-1 {
  transform: translateY(0px);
  height: 45px; 
  /* 正常影線 */
}

/* 2. 第二根：實體縮小，位置墊高，上影線拉長 */
.pos-ab-2 {
  transform: translateY(-15px); /* 創新高 */
  height: 30px; /* 實體縮小 */
  z-index: 2;
}
/* 特製第二根的上影線 */
.pos-ab-2::before {
  top: -10px; /* 影線向上延伸 */
  bottom: -5px;
}

/* 3. 第三根：實體最小，位置微幅墊高，長上影線 */
.pos-ab-3 {
  transform: translateY(-25px); /* 再創新高，但漲幅有限 */
  height: 15px; /* 實體極短 */
  z-index: 2;
}
/* 特製第三根的長上影線 (避雷針) */
.pos-ab-3::before {
  top: -18px; /* 影線更長，顯示賣壓極重 */
  bottom: -5px;
  height: auto; /* 覆蓋預設高度 */
}



/* === 新增：空頭起跑 (Bearish Breakout Top) 專用定位 (參考圖優化版) === */
.bearish-breakout-pattern {
  align-items: center;
  gap: 2px;
  padding-top: 10px;
  min-height: 60px; /* 稍微增加高度容納更深的下跌 */
}

/* 1. 上升軌道：讓漲勢看起來更明確、位置更高 */
.pos-bb-up1 { transform: translateY(5px); } /* 起漲點 */
.pos-bb-up2 { transform: translateY(-10px); }
.pos-bb-up3 { transform: translateY(-25px); } /* 到達高檔區 */

/* 2. 高檔橫盤整理區間：
   設定一個明確的壓力區 (約 0px~2px) 和支撐區 (約 10px~12px)
*/
.pos-bb-c1 { /* 小黑回檔，測支撐 */
  transform: translateY(-20px); 
}
.pos-bb-c2 { /* 小紅反彈，測壓力不過 */
  transform: translateY(-28px);
}
.pos-bb-c3 { /* 再次小黑回檔，測支撐守住 */
  transform: translateY(-18px);
}
.pos-bb-c4 { /* 最後一次反彈無力，高點降低 */
  transform: translateY(-25px);
}

/* 3. 向下突破：長黑 "下殺" 跌破整理區間低點 */
.pos-bb-break {
  /* 中心點大幅下移，確保整根 K 棒都在支撐區(12px)之下，形成明確跌破 */
  transform: translateY(10px); 
  height: 30px; /* 加長黑K實體，增加殺傷力 */
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.5); /* 加重空頭殺盤的光暈 */
  z-index: 2;
}

/* 微調此模式下的 K 棒尺寸，讓整理區間看起來更緊湊 */
.bearish-breakout-pattern .mini { height: 8px; }
.bearish-breakout-pattern .short { height: 15px; }



/* === 空頭三明治 (Bearish Stick Sandwich) 定位優化 === */
.bearish-sandwich-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px;
}

/* 1. 新增：階梯式上升趨勢 (Up Trend) - 紅色 */
.pos-u-trend-1 { transform: translateY(35px); } /* 低點起漲 */
.pos-u-trend-2 { transform: translateY(25px); }
.pos-u-trend-3 { transform: translateY(15px); } /* 漲至高點 */

/* 2. 第一根長紅：建立頂部壓力 */
.pos-bes-1 {
  /* 修改：位置上移至 -10px，與前方趨勢(15px)形成順勢跳空或連續 */
  /* 高度 40px -> 頂部(收盤) -30px，底部(開盤) 10px */
  /* 底部 10px 緊接在趨勢 15px 之後 */
  transform: translateY(-10px);
  height: 40px;
}

/* 3. 第二根黑K：夾心層 */
.pos-bes-2 {
  /* 修改：配合上移 */
  /* 高度 20px -> 頂部(開盤) -15px，底部(收盤) 5px */
  /* 包含在兩根紅K中間 */
  transform: translateY(-5px);
  height: 20px;
}

/* 4. 第三根長紅：再次挑戰壓力 */
.pos-bes-3 {
  /* 關鍵：必須確保頂部(收盤) = -30px (與第一根相同) */
  /* 設定高度 50px */
  /* 計算：中心點 = 目標頂部(-30) + 半高(25) = -5px */
  transform: translateY(-5px);
  height: 50px;
  
  /* 視覺驗證：
     頂部 -5 - 25 = -30px (完美對齊第一根頂部)
     底部 -5 + 25 = 20px (開盤價低於前日收盤 5px，符合開低走高)
  */
  box-shadow: 0 -4px 4px -2px rgba(47, 53, 66, 0.6); /* 頂部黑色光暈暗示壓力 */
  z-index: 2;
}


/* === 下降三法 (Falling Three Methods) 專用定位 === */
.falling-three-pattern {
  align-items: center;
  gap: 3px;
  padding-top: 5px; /* 預留上方突破空間 */
}

/* 中間三根小紅 K：呈現「階梯式向上反彈」 */
/* 它們應該保持在第一根長黑 K 的範圍內 (高點不破黑K頂) */

.pos-f1 {
  /* 第一根反彈：位置較低 (接近黑K底部) */
  transform: translateY(12px); 
}

.pos-f2 {
  /* 第二根反彈：位置居中 */
  transform: translateY(7px);
}

.pos-f3 {
  /* 第三根反彈：位置較高，但不過高 */
  transform: translateY(2px);
}

/* 最後一根長黑 K：向下跌破，位置要比第一根更低 */
.pos-f-break {
  transform: translateY(15px); /* 往下殺，視覺上跌破整理區間 */
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.4); /* 加重跌勢陰影 */
  z-index: 2;
}


/* === 新增：三山 (Three Mountains / Head and Shoulders Top) 專用定位 === */
.three-mountains-pattern {
  align-items: center;
  gap: 2px; /* K棒緊密排列 */
  padding-top: 5px; /* 預留頭部向上空間 */
  min-height: 110px; /* 增加整體高度以容納波動 */
  /* 視覺上的頸線大約在 translateY(15px) 的位置 */
}

/* 1. 上升趨勢起點 */
.pos-tm-1 { transform: translateY(30px); }

/* 2. 左肩峰 (位置較高) */
.pos-tm-ls { transform: translateY(-5px); }

/* 3. 左肩谷底 (回到頸線位置 15px) */
.pos-tm-nk1 { transform: translateY(15px); }

/* 4. 頭部峰 (最高點，比肩膀更高) */
.pos-tm-head {
  transform: translateY(-25px); /* 最高峰 */
  height: 45px; /* 拉長紅K顯示氣勢 */
  z-index: 2;
}

/* 5. 右肩谷底 (回到頸線 15px，支撐確認) */
.pos-tm-nk2 { transform: translateY(15px); }

/* 6. 右肩峰 (與左肩差不多高，但低於頭部) */
.pos-tm-rs { transform: translateY(-5px); }

/* 7. 跌破頸線 (關鍵長黑向下摜破) */
.pos-tm-break {
  /* 位置大幅下移，明顯低於頸線(15px) */
  transform: translateY(35px); 
  height: 50px; /* 長黑確認 */
  box-shadow: 0 0 10px rgba(47, 53, 66, 0.5); /* 增加殺盤陰影 */
  z-index: 2;
}



